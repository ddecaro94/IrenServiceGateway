<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Client</title>

    <!-- JQUERY -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <!-- ICONE MATERIALS -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- BOOTSTRAP -->

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <script type="text/javascript">
        $(document).ready(function() {
            $('[data-toggle="popover"]').popover({
                html: true,
                template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-footer"><a href="#" class="btn btn-info btn-sm">Yes</a><a href="#" class="btn btn-info btn-sm pull-right">No</a></div></div></div>'
            });

            // Custom jQuery to hide popover on click of the close button
            $(document).on("click", ".popover-footer .btn", function() {
                $(this).parents(".popover").popover('hide');
            });
        });
    </script>

    <style type="text/css">
        .form-group input[type="checkbox"] {
            display: none;
        }
        
        .form-group input[type="checkbox"] + .btn-group > label span:last-child {
            display: none;
        }
        
        .form-group input[type="checkbox"] + .btn-group > label span:first-child {
            display: inline-block;
        }
        
        .form-group input[type="checkbox"]:checked + .btn-group > label span:last-child {
            display: inline-block;
        }
        
        .form-group input[type="checkbox"]:checked + .btn-group > label span:first-child {
            display: none;
        }
    </style>

    <script type="text/javascript" src="http://ibmsvlib01:7800/sys/download?filename=/scripts/bootstrap-filestyle.js"></script>

    <script type="text/javascript" src="http://ibmsvlib01:7800/sys/download?filename=/scripts/typeahead.js"></script>

    <style type="text/css">

        
        .scrollable-menu {
            min-width: 220px;
            max-height: 60vh;
            overflow: auto;
        }
        
        .scrollable-tbody {
            display: block;
            max-height: 60vh;
            overflow-y: scroll;
            overflow-x: hidden;
        }
        
        .table thead,
        tbody tr {
            display: table;
            width: 100%;
            table-layout: fixed;
        }
		
        .service-gw {
            position: relative;
            margin: 20px;
        }
		
		.service-gw td {
			text-align: center;
		}
		
		.service-gw th {
			text-align: center;
		}
        
        .typeahead,
        .tt-query,
        .tt-hint {
            border: 2px solid #CCCCCC;
            border-radius: 8px;
            font-size: 22px;
            /* Set input font size */
            height: 30px;
            line-height: 30px;
            outline: medium none;
            padding: 8px 12px;
            width: 396px;
        }
        
        .typeahead {
            background-color: #FFFFFF;
        }
        
        .typeahead:focus {
            border: 2px solid #0097CF;
        }
        
        .tt-query {
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset;
        }
        
        .tt-hint {
            color: #999999;
        }
        
        .tt-menu {
            background-color: #FFFFFF;
            border: 1px solid rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            margin-top: 12px;
            padding: 8px 0;
            width: 422px;
        }
        
        .tt-suggestion {
            font-size: 22px;
            /* Set suggestion dropdown font size */
            padding: 3px 20px;
        }
        
        .tt-suggestion:hover {
            cursor: pointer;
            background-color: #0097CF;
            color: #FFFFFF;
        }
        
        .tt-suggestion p {
            margin: 0;
        }
    </style>

</head>

<body>
    <div class="service-gw">

        <nav class="navbar navbar-default">

            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" data-target="#navbarCollapse" data-toggle="collapse" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <img class="navbar-brand" src="https://www.gruppoiren.it/iren_gruppo-theme/images/logo_iren_color.png"></img>
            </div>

            <!-- Collection of nav links, forms, and other content for toggling -->
            <div id="navbarCollapse" class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">Menu <b class="caret"></b></a>
                        <ul id="action-menu" class="dropdown-menu scrollable-menu">
                            <li><a href="#actionA" data-toggle="modal">Gestione Utenti</a></li>
                            <li><a href="#actionB" data-toggle="modal">Recupero iva cessati Upload </a></li>
                            <li><a href="#actionC" data-toggle="modal">Recupero iva cessati Download </a></li>
                        </ul>
                    </li>
                </ul>
            </div>

        </nav>

        <div class="container">
            <div class="jumbotron">
                <h1 class="display-3">Services Gateway</h1>
                <p class="display-3">Scegli l'operazione che desideri eseguire dalla lista in alto a destra.</p>
            </div>
        </div>
    </div>

    <!-- Modal HTML -->
    <div id="actionA" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="service-gw">
                    <h1>Gestione Utente</h1>
                    <hr>
                    <form id="addUser" class="form-horizontal" action="http://ibmsvlib01:7800/sys/users" method="post">
                        <div class="form-group">
                            <div class="col-lg-9">
                                <input type="text" class="form-control" id="firstName" placeholder="Crea nuovo utente" required>
                            </div>
                            <div class="col-sm-3 pull-right">
                                <input type="submit" class="btn btn-primary" value="Crea">
                            </div>
                        </div>

                    </form>

                    <br>

                    <div class="service-gw" style="margin-left: 0px;">
                        <h3>Trova utente</h3>
                        <input id="searchUser" type="text" class="typeahead tt-query" autocomplete="off" spellcheck="false">
                    </div>
                    <div class="form-group">
                        <p id="demo"> </p>
                    </div>
                </div>

                <div class="service-gw">

                    <table class="table table-striped">
                        <thead style="max-width: 96%;">
                            <tr>
                                <th>Id</th>
                                <th>Utente</th>
                                <th>Delete</th>
                                <th>Settings</th>
                            </tr>
                        </thead>
                        <tbody id="users" class="scrollable-tbody">

                        </tbody>
                    </table>
					
					<div class="modal-footer">

                    <img class="navbar-brand" src="https://www.gruppoiren.it/iren_gruppo-theme/images/logo_iren_color.png"></img>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
                </div>
                <script>
					function parseQuery(qstr) {
						var query = {};
						var a = (qstr[0] === '?' ? qstr.substr(1) : qstr).split('&');
						for (var i = 0; i < a.length; i++) {
							var b = a[i].split('=');
							query[decodeURIComponent(b[0])] = decodeURIComponent(b[1] || '');
						}
						return query;
					};

					var engine = null;
					var token = parseQuery(window.location.search).user;
					
					function refreshUsers(){
						var contact = null;
						var xhttp = new XMLHttpRequest();
						xhttp.onreadystatechange = function() {
							if (this.readyState == 4 && this.status == 200) {
								// Typical action to be performed when the document is ready:
								contact = xhttp.responseText;
								var body = $("#users");
								body.empty();
								var users = JSON.parse(contact).map(function(obj) {
									return obj.USERNAME;
								});
								JSON.parse(contact).forEach(function(obj) {
									body.append('<tr>' +
										'<td style="vertical-align:middle;">' + obj.ID_USER + '</td>' +
										'<td style="vertical-align:middle;">' + obj.USERNAME + '</td>' +
										'<td style="vertical-align:middle;">' +
										'<a href="#" class="material-icons" data-toggle="confirmation" style="font-size:25px;color:red" >delete_sweep</a>' +
										'</td>' +
										'<td style="vertical-align:middle;"><a href="#regole"  class="material-icons" data-toggle="modal" style="font-size:25px;" onclick="loadPermissions($(this).parent().parent().children()[0].innerText)">https</a></td></tr>');
								});
								
                                engine.clear();
                                engine.local = users;
                                engine.initialize(true);
							}
						};
						xhttp.open("GET", "http://ibmsvlib01:7800/sys/users", true);
						xhttp.send();
					};
				
					function loadPermissions(id){
						$.ajax({
                            type: "GET",
                            cache: false,
                            url: 'http://ibmsvlib01:7800/sys/permissions/'+id+'?user=' + token,
                            data: '',
                            success: function(data) {
								var permissions = $('#permissions');
								permissions.empty();
                                data.forEach(function(obj) {
									if(obj.ALLOWED == 'BLANK'){
										permissions.append(
											'<tr id='+id+'-'+obj.ID_RES+'><td>'+obj.NAME+'</td><td>'+
													'<div class="row">'+
														'<div class="col-md-12">'+

															'<div class="btn-group btn-toggle pull-right">'+
																'<button class="btn btn-xs disabled btn-primary">ON</button>'+
																'<button class="btn btn-xs disabled btn-default">OFF</button>'+
															'</div></div></div></td>'+
											'</tr>');
									
									} else {
										if(obj.ALLOWED == 'YES'){
											permissions.append(
											'<tr id='+id+'-'+obj.ID_RES+'><td>'+obj.NAME+'</td><td>'+
													'<div class="row">'+
														'<div class="col-md-12">'+

															'<div class="btn-group btn-toggle pull-right">'+
																'<button class="btn btn-xs btn-primary active ">ON</button>'+
																'<button class="btn btn-xs btn-default">OFF</button>'+
															'</div></div></div></td>'+
											'</tr>');
										} else {
											permissions.append(
											'<tr id='+id+'-'+obj.ID_RES+'><td>'+obj.NAME+'</td><td>'+
													'<div class="row">'+
														'<div class="col-md-12">'+

															'<div class="btn-group btn-toggle pull-right">'+
																'<button class="btn btn-xs btn-default">ON</button>'+
																'<button class="btn btn-xs btn-primary active">OFF</button>'+
															'</div></div></div></td>'+
											'</tr>');
										};					
									}
								});
								$('.btn-toggle').click(function() {
									if ($(this).find('.active').size() > 0) {
										$(this).find('.btn').toggleClass('active');
										$(this).find('.btn').toggleClass('btn-primary');
									}
									
									$(this).find('.btn').toggleClass('btn-default');
								});
                            }
                        });
					};
					
					function postPermissions() {
						var data = $('#permissions tr').toArray();
						var id = data[0].id.substring(0,10);
						var permissions = data.filter(function(obj){
							return($(obj).find('.active')[0].innerText == 'ON');
						}).map(function(obj){
							var idRes = obj.id.substring(11, 21);
							return idRes;
						});
						
						
						$.ajax({
                            type: "POST",
                            cache: false,
                            url: 'http://ibmsvlib01:7800/sys/permissions/'+id+'?user=' + token,
                            data: JSON.stringify(permissions),
                            success: function(data) {
								alert('SAVED SUCCESSFULLY');
                            },
							error: function(e){
								alert(e.status+' '+e.statusText);
							}
                        });
					};
					

					
					
					$(document).ready(function(e) {
						refreshUsers();
						
						// Constructing the suggestion engine
						engine = new Bloodhound({
							datumTokenizer: Bloodhound.tokenizers.whitespace,
							queryTokenizer: Bloodhound.tokenizers.whitespace,
							local: users
						});
						
						// Initializing the typeahead
						$('.typeahead').typeahead({
							hint: true,
							highlight: true,
							/* Enable substring highlighting */
							minLength: 1 /* Specify minimum characters required for showing result */
						}, {
							name: 'users',
							source: engine
						});
							
						$("#searchUser").keyup(function(e) {
							var username = $("#searchUser").val();
							var rows = $("#users").find("tr").hide();
							if (this.value.length) {
								var data = this.value.split(" ");
								$.each(data, function(i, v) {
									rows.filter(":contains('" + username + "')").show();
								});
							} else rows.show();

						});

						$("#searchUser").change(function(e) {
							var username = $("#searchUser").val();
							var rows = $("#users").find("tr").hide();
							if (this.value.length) {
								var data = this.value.split(" ");
								$.each(data, function(i, v) {
									rows.filter(":contains('" + username + "')").show();
								});
							} else rows.show();

						});
					});
					
		
                    $("#addUser").submit(function(e) {
                        e.preventDefault();
                        e.stopImmediatePropagation();
                        $.ajax({
                            type: "POST",
                            cache: false,
                            url: $(this).attr('action') + '?username=' + $("#firstName").val(),
                            data: '',
                            success: function(data) {
                                refreshUsers();
                            }
                        });

                    });
                </script>

                

            </div>
        </div>

        <div id="regole" class="modal fade">

            <div class="modal-dialog pull-right" style="max-width:30vw; height:60vh; margin-right:2vw">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Confirmation</h4>
                    </div>

                    <div class="service-gw">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Servizio</th>

                                    <th class="pull-right">Grant</th>
                                </tr>
                            </thead>
                            <tbody id="permissions" class="scrollable-tbody">
                                <tr>
                                    <td>NomeServizio</td>

                                    <td>
                                        <div class="row">
                                            <div class="col-md-12">

                                                <div class="btn-group btn-toggle pull-right">
                                                    <button class="btn btn-xs btn-default">ON</button>
                                                    <button class="btn btn-xs btn-primary active">OFF</button>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>NomeServizio</td>

                                    <td>
                                        <div class="row">
                                            <div class="col-md-12">

                                                <div class="btn-group btn-toggle pull-right">
                                                    <button class="btn btn-xs btn-default">ON</button>
                                                    <button class="btn btn-xs btn-primary active">OFF</button>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>NomeServizio</td>

                                    <td>
                                        <div class="row">
                                            <div class="col-md-12">

                                                <div class="btn-group btn-toggle pull-right">
                                                    <button class="btn btn-xs btn-default">ON</button>
                                                    <button class="btn btn-xs btn-primary active">OFF</button>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" onclick="postPermissions()">Save changes</button>
                        </div>
                        </div>
                        </div>
                        </div>
                        </div>

                        <!-- Modal HTML -->
                        <div id="actionB" class="modal fade">

                            <div class="modal-dialog">
                                <div class="modal-content">

                                    <div class="service-gw">

                                        <div class="span12">

                                            <form id="upload" role="form" action="http://ibmsvlib01:7800/sys/upload_csv?db=INT_ENGINE&nomeTabella=IIB_CSV_TEMP&formatoData=yyyymmdd&separatore=|" enctype="multipart/form-data" method="post">
                                                <h2>Upload File</h2>
                                                <hr>
                                                <div class="row">

                                                    <div class="col-xs-12">

                                                        <div class="form-group">

                                                            <input type="file" name="example" id="input05">
															
                                                        </div>

                                                    </div>
													<div class="col-xs-12">
													<input type="submit" class="btn btn-primary" value="Submit">
                                                            <input type="reset" class="btn btn-default" value="Reset" onclick="myFunction1()">
													</div>
                                                </div>

                                                <div class="form-group">

                                                    <p id="demo1"> </p>

                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <div class="form-group">
                                                            <div class="col-xs-offset-4 col-xs-12">
                                                                

                                                                <script>
                                                                    function myFunction1() {
                                                                        document.getElementById("demo1").innerHTML = ' <class="alert alert-success alert-dismissable" style="background-color:white; border-color:white">';
                                                                    }
                                                                </script>

                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </form>
											
                                            <script>
												$.support.cors = true;
                                                var fileInput = document.getElementById('input05');

                                                var file;
                                                var textType = /text.*/;
                                                var reader;

                                                fileInput.addEventListener('change', function(e) {
                                                    file = fileInput.files[0];
                                                    if (file.type.match(textType)) {
                                                        reader = new FileReader();

                                                        reader.onload = function(e) {
                                                            fileDisplayArea.innerText = reader.result;
                                                            document.getElementById("demo1").innerHTML = ' <class="alert alert-success alert-dismissable" style="background-color:white; border-color:white">';

                                                        }

                                                        reader.readAsText(file);
                                                    } else {
                                                        fileDisplayArea.innerText = "File not supported!";
                                                    }
                                                });

                                                $("#upload").submit(function(e) {

                                                    /*fileDisplayArea.innerText = reader.result;*/

                                                    e.preventDefault();
                                                    e.stopImmediatePropagation();
                                                    $.ajax({
                                                        type: "POST",
                                                        cache: false,
                                                        url: $(this).attr('action'),
                                                        data: reader.result,
                                                        dataType: 'json',
                                                        success: function(data) {

                                                            var messaggio = '';

                                                            var text = JSON.stringify(data);

                                                            if (data.info.status == true) {

                                                                // messaggio = messaggio + ' <div class="alert alert-success alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a> <strong>Success!</strong> <a href="P:\">'+ data.info.description +' </div>';	
                                                                messaggio = messaggio + ' <div class="alert alert-success">  <strong>Success!</strong><a href="P:\">' + data.info.description + ' </div>';

                                                                document.getElementById("demo1").innerHTML = messaggio;
                                                            } else {
                                                                //messaggio = messaggio +'<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a><strong>Danger!</strong>'+  data.info.description +' </div>';
                                                                messaggio = messaggio + ' <div class="alert alert-danger">  <strong>Errore!</strong><a href="P:\">' + data.info.description + ' </div>';

                                                                document.getElementById("demo1").innerHTML = messaggio;
                                                            }

                                                        }
                                                    });

                                                });
                                            </script>

                                        </div>
                                    <div class="modal-footer">

                                        <img class="navbar-brand" src="https://www.gruppoiren.it/iren_gruppo-theme/images/logo_iren_color.png"></img>
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    </div>
                                    </div>



                                </div>
                            </div>

                        </div>

                        <!-- Modal HTML -->
                        <div id="actionC" class="modal fade">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                    <div class="service-gw">
                                        <h1>Parameters</h1>
										<hr>
                                        <!--form id="upload" role="form" action="http://ibmsvlib01:7800/sys/download_clob?db=INT_ENGINE" enctype="multipart/form-data" method="post"-->
                                        <form id="download" class="form-horizontal" action="http://ibmsvlib01:7800/sys/download_clob?db=INT_ENGINE" enctype="multipart/form-data" method="post">
                                            <div class="form-group">
                                                <label class="control-label col-xs-3" for="nometabella">nometabella:</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="nometabella" placeholder="nometabella" required>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="control-label col-xs-3" for="nomechiave">nomechiave:</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="nomechiave" placeholder="nomechiave" required>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="control-label col-xs-3" for="valorechiave">valorechiave:</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="valorechiave" placeholder="valorechiave" required>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="control-label col-xs-3" for="nomefile">nomefile:</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="nomefile" placeholder="nomefile" required>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="control-label col-xs-3" for="nomeclob">nomeclob:</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="nomeclob" placeholder="nomeclob" required>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="control-label col-xs-3" for="posizione">posizione:</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="posizione" placeholder="posizione" required>
                                                </div>
                                            </div>

                                            <div class="col-xs-12">
                                                <p id="messaggio"> </p>
                                            </div>

                                            <br>
                                            <div class="form-group">
                                                <div class="col-xs-offset-3 col-xs-9">
                                                    <input type="submit" class="btn btn-primary" value="Submit">
                                                    <input type="reset" class="btn btn-default" value="Reset" onclick="printMessage()">

                                                    <script>
                                                        function printMessage() {
                                                            document.getElementById("messaggio").innerHTML = ' <class="alert alert-success alert-dismissable" style="background-color:white; border-color:white">';;
                                                        }
                                                    </script>

                                                </div>
                                            </div>
                                        </form>
                                        <script>
											$.support.cors = true;
                                            $("#download").submit(function(e) {

                                                var messaggioJson = '{"Parameters": [{ ' + '"nometabella": "' + document.getElementById("nometabella").value + '",' + '"nomechiave": "' + document.getElementById("nomechiave").value + '",' + '"valorechiave": "' + document.getElementById("valorechiave").value + '",' + '"nomefile": "' + document.getElementById("nomefile").value + '",' + '"nomeclob": "' + document.getElementById("nomeclob").value + '",' + '"posizione": "' + document.getElementById("posizione").value + '"' + '}]}';

                                                //document.getElementById("messaggio").innerHTML = messaggioJson;

                                                e.preventDefault();
                                                e.stopImmediatePropagation();
                                                $.ajax({
                                                    type: "POST",
                                                    cache: false,
                                                    url: $(this).attr('action'),
                                                    data: messaggioJson,
                                                    dataType: 'json',
                                                    success: function(data) {

                                                        var messaggio = '';

                                                        var text = JSON.stringify(data);

                                                        <!--document.getElementById("demo").innerHTML = data.info.status; -->

                                                        if (data.info.status == true) {

                                                            // messaggio = messaggio + ' <div class="alert alert-success alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a> <strong>Success!</strong> <a href="P:\">'+ data.info.description +' </div>';	
                                                            messaggio = messaggio + ' <div class="alert alert-success">  <strong>Success!</strong><a href="P:\">' + data.info.description + ' </div>';

                                                            document.getElementById("messaggio").innerHTML = messaggio;
                                                        } else {
                                                            //messaggio = messaggio +'<div class="alert alert-danger alert-dismissable"><a href="#" class="close" data-dismiss="alert" aria-label="close">×</a><strong>Danger!</strong>'+  data.info.description +' </div>';
                                                            messaggio = messaggio + ' <div class="alert alert-danger">  <strong>Errore!</strong><a href="P:\">' + data.info.description + ' </div>';

                                                            document.getElementById("messaggio").innerHTML = messaggio;
                                                        }

                                                    },
                                                    error: function(jqXHR, textStatus, errorThrown) {
                                                        var messaggio = '';
                                                        messaggio = messaggio + ' <div class="alert alert-danger">  <strong>Errore!</strong> ' + textStatus + ' - ' + errorThrown + ' </div>';

                                                        document.getElementById("messaggio").innerHTML = messaggio;
                                                    }
                                                });

                                            });
                                        </script>

                                        <div class="modal-footer">

                                            <img class="navbar-brand" src="https://www.gruppoiren.it/iren_gruppo-theme/images/logo_iren_color.png"></img>
                                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>

                        <div class="modal fade">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        <h4 class="modal-title">Confirmation</h4>
                                    </div>

                                    <div class="modal-body">
                                        <p>Do you want to save changes you made to document before closing?</p>
                                        <p class="text-warning"><small>If you don't save, your changes will be lost.</small></p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Modal HTML -->

                        <script>
                            $(function() {
                                $('body').confirmation({
                                    selector: '[data-toggle="confirmation"]'
                                });

                                $('.confirmation-callback').confirmation({
                                    onConfirm: function() {
                                        alert('confirm')
                                    },
                                    onCancel: function() {
                                        alert('cancel')
                                    }
                                });
                            });
                        </script>

                        <script>
                            /*!
                             * Bootstrap Confirmation v1.0.5
                             * https://github.com/tavicu/bs-confirmation
                             */
                            + function(a) {
                                "use strict";
                                var b = !1,
                                    c = function(c, d) {
                                        var e = this;
                                        this.init("confirmation", c, d), a(c).on("show.bs.confirmation", function(b) {
                                            e.options.onShow(b, this), a(this).addClass("open");
                                            var c = e.options,
                                                d = c.all_selector;
                                            c.singleton && a(d).not(e.$element).each(function() {
                                                a(this).hasClass("open") && a(this).confirmation("hide")
                                            })
                                        }), a(c).on("hide.bs.confirmation", function(b) {
                                            e.options.onHide(b, this), a(this).removeClass("open")
                                        }), a(c).on("shown.bs.confirmation", function(c) {
                                            var d = e.options;
                                            d.all_selector;
                                            e.isPopout() && (b || (b = a("body").on("click", function(c) {
                                                e.$element.is(c.target) || e.$element.has(c.target).length || a(".popover").has(c.target).length || (e.hide(), e.inState.click = !1, a("body").unbind(c), b = !1)
                                            })))
                                        }), d.selector ? a(c).on("click.bs.confirmation", d.selector, function(a) {
                                            a.preventDefault()
                                        }) : a(c).on("click.bs.confirmation", function(a) {
                                            a.preventDefault()
                                        })
                                    };
                                if (!a.fn.popover || !a.fn.tooltip) throw new Error("Confirmation requires popover.js and tooltip.js");
                                c.VERSION = "1.0.5", c.DEFAULTS = a.extend({}, a.fn.popover.Constructor.DEFAULTS, {
                                    placement: "right",
                                    title: "Sei sicuro?",
                                    btnOkClass: "btn btn-sm btn-danger",
                                    btnOkLabel: "Delete",
                                    btnOkIcon: "glyphicon glyphicon-ok",
                                    btnCancelClass: "btn btn-sm btn-default",
                                    btnCancelLabel: "Cancel",
                                    btnCancelIcon: "glyphicon glyphicon-remove",
                                    target: "_self",
                                    singleton: !0,
                                    popout: !0,
                                    onShow: function(a, b) {},
                                    onHide: function(a, b) {},
                                    onConfirm: function(a, b) {
										//codice gestione cancellazione utente
										var el = b.parent().parent().children()[0].innerText;
										alert(b.parent().parent().children()[0].innerText);
										
										$.ajax({
											type: "DELETE",
											cache: false,
											url: "http://ibmsvlib01:7800/sys/users/" + b.parent().parent().children()[0].innerText,
											data: '',
											success: function(data) {
												alert('CANCELLATO');
												refreshUsers();
											},
											error: function(data) {
												alert('UTENTE NON PRESENTE');
											}
										});
										
									},
                                    onCancel: function(a, b) {},
                                    template: '<div class="popover" style="width:180px"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"><a data-apply="confirmation">Yes</a><a data-dismiss="confirmation">No</a></div></div>'
                                }), c.prototype = a.extend({}, a.fn.popover.Constructor.prototype), c.prototype.constructor = c, c.prototype.getDefaults = function() {
                                    return c.DEFAULTS
                                }, c.prototype.setContent = function() {
                                    var b = this,
                                        c = this.tip(),
                                        d = this.getTitle(),
                                        e = c.find('[data-apply="confirmation"]'),
                                        f = c.find('[data-dismiss="confirmation"]'),
                                        g = this.options;
                                    e.addClass(this.getBtnOkClass()).html(this.getBtnOkLabel()).prepend(a("<i></i>").addClass(this.getBtnOkIcon()), " ").attr("href", this.getHref()).attr("target", this.getTarget()).off("click").on("click", function(a) {
                                        g.onConfirm(a, b.$element), "submit" == b.$element.attr("type") && b.$element.closest("form").first().submit(), b.hide(), b.inState.click = !1
                                    }), f.addClass(this.getBtnCancelClass()).html(this.getBtnCancelLabel()).prepend(a("<i></i>").addClass(this.getBtnCancelIcon()), " ").off("click").on("click", function(a) {
                                        g.onCancel(a, b.$element), b.hide(), b.inState.click = !1
                                    }), c.find(".popover-title")[this.options.html ? "html" : "text"](d), c.removeClass("fade top bottom left right in"), c.find(".popover-title").html() || c.find(".popover-title").hide()
                                }, c.prototype.getBtnOkClass = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-btnOkClass") || ("function" == typeof b.btnOkClass ? b.btnOkClass.call(this, a[0]) : b.btnOkClass)
                                }, c.prototype.getBtnOkLabel = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-btnOkLabel") || ("function" == typeof b.btnOkLabel ? b.btnOkLabel.call(this, a[0]) : b.btnOkLabel)
                                }, c.prototype.getBtnOkIcon = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-btnOkIcon") || ("function" == typeof b.btnOkIcon ? b.btnOkIcon.call(this, a[0]) : b.btnOkIcon)
                                }, c.prototype.getBtnCancelClass = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-btnCancelClass") || ("function" == typeof b.btnCancelClass ? b.btnCancelClass.call(this, a[0]) : b.btnCancelClass)
                                }, c.prototype.getBtnCancelLabel = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-btnCancelLabel") || ("function" == typeof b.btnCancelLabel ? b.btnCancelLabel.call(this, a[0]) : b.btnCancelLabel)
                                }, c.prototype.getBtnCancelIcon = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-btnCancelIcon") || ("function" == typeof b.btnCancelIcon ? b.btnCancelIcon.call(this, a[0]) : b.btnCancelIcon)
                                }, c.prototype.getHref = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-href") || ("function" == typeof b.href ? b.href.call(this, a[0]) : b.href)
                                }, c.prototype.getTarget = function() {
                                    var a = this.$element,
                                        b = this.options;
                                    return a.attr("data-target") || ("function" == typeof b.target ? b.target.call(this, a[0]) : b.target)
                                }, c.prototype.isPopout = function() {
                                    var a, b = this.$element,
                                        c = this.options;
                                    return a = b.attr("data-popout") || ("function" == typeof c.popout ? c.popout.call(this, b[0]) : c.popout), "false" == a && (a = !1), a
                                };
                                var d = a.fn.confirmation;
                                a.fn.confirmation = function(b) {
                                    var d = this;
                                    return this.each(function() {
                                        var e = a(this),
                                            f = e.data("bs.confirmation"),
                                            g = "object" == typeof b && b;
                                        g = g || {}, g.all_selector = d.selector, (f || "destroy" != b) && (f || e.data("bs.confirmation", f = new c(this, g)), "string" == typeof b && f[b]())
                                    })
                                }, a.fn.confirmation.Constructor = c, a.fn.confirmation.noConflict = function() {
                                    return a.fn.confirmation = d, this
                                }
                            }(jQuery);
                        </script>

                        <div>



                            <script type="text/javascript">
                                $('#input05').filestyle({
                                    buttonName: 'btn-warning'
                                });
                            </script>

</body>

</html>