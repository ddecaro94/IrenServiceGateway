<!-- Modal HTML -->
<div id="SE3ChiusuraContratti" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="service-gw">
				<div class="span12">
					<form id="upload" role="form" action="/sys/upload_csv?db=C1&nomeTabella=A1336_SWITCH_OUT&chiave=A1336_ID_SWITCH_OUT&sequence=A1336_SWITCH_OUT_SEQ&chiaveUnica=NO&separatore=;&formatoData=dd/mm/yyyy&separatoreDecimali=,." enctype="multipart/form-data" method="post">
						<h2>Caricamento SE3 Chiusura Contratti</h2>
						<hr>
						<div class="row">
							<div class="col-xs-12">
								<div class="form-group">
									<input type="file" name="example" id="chiusura-contratti-file">
								</div>
							</div>
							<div class="col-xs-12">
								<input type="submit" class="btn btn-primary" value="Submit">
								<input type="reset" class="btn btn-default" value="Reset" onclick="resetSE3ChiusuraContrattiMessage()">
							</div>
						</div>
						<div id="SE3ChiusuraContrattiMessage">
						</div>
						<div class="row">
							<div class="col-xs-12">
								<div class="form-group">
									<div class="col-xs-offset-4 col-xs-12">
										<script>
											function resetSE3ChiusuraContrattiMessage() {
											    $('#RecuperoIvaCessatiUploadMessage').replaceWith('<div id="RecuperoIvaCessatiUploadMessage"></div>');
											}
										</script>
									</div>
								</div>
							</div>
						</div>
					</form>
					<script>
						$.support.cors = true;
						var fileInput = document.getElementById('chiusura-contratti-file');

						var file;
						var textType = /text.*/;
						var reader;

						fileInput.addEventListener('change', function(e) {
							file = fileInput.files[0];
							if (file.type.match(textType)) {
								reader = new FileReader();
								reader.readAsText(file);
							} else {
								$('#SE3ChiusuraContrattiMessage').replaceWith('<div id="SE3ChiusuraContrattiMessage" class="alert alert-info"><strong>Errore! </strong> File non supportato</div>');
							}
						});

						$("#upload").submit(function(e) {

							e.preventDefault();
							e.stopImmediatePropagation();
							$.ajax({
								type: "POST",
								cache: false,
								url: $(this).attr('action'),
								data: reader.result,
								dataType: 'json',
								success: function(data) {

									var messaggio = '';

									if (data.info.status == true) {
									   $('#SE3ChiusuraContrattiMessage').replaceWith('<div id="SE3ChiusuraContrattiMessage" class="alert alert-success"><strong>Successo! </strong>' + data.info.description + '</div>');
									} else {
										$('#SE3ChiusuraContrattiMessage').replaceWith('<div id="SE3ChiusuraContrattiMessage" class="alert alert-danger"><strong>Errore! </strong>' + data.info.description + '</div>');
									}
								}
							});

						});
						                                
					</script>
				</div>
				<div class="modal-footer">
					<img class="navbar-brand" src="https://www.gruppoiren.it/iren_gruppo-theme/images/logo_iren_color.png"></img>
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		$('#chiusura-contratti-file').filestyle({
			buttonName: 'btn-warning'
		});
	</script>
</div>